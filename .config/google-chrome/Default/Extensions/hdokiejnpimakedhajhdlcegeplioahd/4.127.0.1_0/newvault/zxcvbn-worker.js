try{function addToDictionary(e,a){Object.keys(a).forEach(function(x){e[x]?e[x].concat(a[x]):e[x]=a[x]})}function setupZXCVBN(x){var e={},e=(addToDictionary(e,zxcvbnts["language-common"].dictionary),addToDictionary(e,zxcvbnts["language-en"].dictionary),addToDictionary(e,zxcvbnts["language-de"].dictionary),addToDictionary(e,zxcvbnts["language-es-es"].dictionary),addToDictionary(e,zxcvbnts["language-fr"].dictionary),addToDictionary(e,zxcvbnts["language-it"].dictionary),addToDictionary(e,zxcvbnts["language-nl-be"].dictionary),addToDictionary(e,zxcvbnts["language-pt-br"].dictionary),{useLevenshteinDistance:x,translations:zxcvbnts["language-en"].translations,graphs:zxcvbnts["language-common"].adjacencyGraphs,dictionary:e});zxcvbnts.core.zxcvbnOptions.setOptions(e),useLevenshteinDistance=x}function challengegetstrength(x,e,a){var s=25;return a?calculatePasswordStrength(e,x)*s:calculateStrengthLegacy(e,x)*s}function calculatePasswordStrength(x,e){var a,x,a,s;if("undefined"!=typeof zxcvbnts)return a=/\s/g,x=x?x.substring(0,50).replace(a,""):"",a=e?e.substring(0,50).toLowerCase():"",zxcvbnts.core.zxcvbn(x,[a,"lastpass","lastpass.com"]).score;console.error("No zxcvbn functionality available")}function calculateStrengthLegacy(x,e){var x,e,a;if("undefined"!=typeof zxcvbn)return x=x?x.substring(0,50):"",e=e?e.substring(0,50).toLowerCase():"",zxcvbn(x,[e,"lastpass","lastpass.com"]).score;console.error("No zxcvbn functionality available"),sendPostMessage()}function challengecomputescore_async(k,e,C,a,s,t,n,r,F,R,V,o,H,i,d,c,X,l,g,v,u,h,p,m,f,_,b,y,S,Z,w,j,z,D,B,E,W,I,J,K,q,G){function Q(){postMessage({cmd:"report",runtimesec:void 0!==vx?vx:void 0,calcTimeMs:void 0!==startTime?(new Date).getTime()-startTime:void 0,g_totalscore:void 0!==e?e:void 0,g_aSites:void 0!==a?a:void 0,g_numsites:void 0!==s?s:0,g_numblanksites:void 0!==t?t:0,g_avgpasswordlength:void 0!==n?n:0,g_avgstrength:"undefined"!=typeof g_avgstrength?g_avgstrength:0,g_aPasswords:void 0!==r?r:{},g_MAXNUMCOMPUTESCORE:void 0!==F?F:0,g_numduppasswords:void 0!==R?R:0,g_numdupsites:void 0!==V?V:0,g_usernames:void 0!==o?o:[],WEAKPASSWORDSCORE:void 0!==H?H:50,g_strengthscore:void 0!==i?i:0,g_countscore:void 0!==d?d:0,g_numweak:void 0!==c?c:0,sharedavgstrength:void 0!==X?X:[],SharedAccounts:void 0!==l?l:[],g_runtimems:void 0!==g?g:0,sfcounts:void 0!==v?v:[],sharedstrengthscore:void 0!==u?u:[],sharedblanksites:void 0!==h?h:[],sharedweak:void 0!==p?p:[],sharedavgpasswordlength:void 0!==m?m:[],SharedPasswords:void 0!==f?f:[],sharedcountscore:void 0!==_?_:[],NonSharedAccounts:void 0!==b?b:[],g_SFNames:void 0!==y?y:[],AllSFNames:void 0!==S?S:[],sharedtotalscore:void 0!==Z?Z:[],g_numvulnerablesites:void 0!==w?w:0,g_allPasswords:void 0!==j?j:{},g_reuse:void 0!==z?z:void 0,g_blanksites:void 0!==D?D:void 0,g_allnumduppasswords:void 0!==B?B:0})}if(0!==e)Q(),console.log("Not processing security score");else{var T,Y=0,x,$,N,xx,ex,ax,P;for(E=void 0===E?{}:E,void 0!==a[T=void 0===k?0:k]&&void 0!==a[T].sfname&&(x=a[T].sfname),void 0===u&&(u=[]),void 0===h&&(h=[]),void 0===p&&(p=[]),void 0===m&&(m=[]),void 0===f&&(f=[]),void 0===_&&(_=[]),void 0===b&&(b=[]),void 0===y&&(y=[]),void 0===S&&(S=[]),void 0===(v=void 0===v?[]:v)[x=void 0===x?"nonshared":x]&&(v[x]=0),v[x]++,void 0===k&&(g_challengeregexcache=[]);T<s;++T){var x,U=("function"==typeof reportprogress&&reportprogress(T,s),x="nonshared",void 0!==a[T].sfname&&(x=a[T].sfname),a[T].usernamedec),L,L=(L=a[T].passworddec)||"",O=a[T].passworddecfix,M=a[T].domain2lvl,sx=void 0!==a[T].realdomain2lvl?a[T].realdomain2lvl:M,tx=void 0!==a[T].vulnerable,sx=(void 0===t&&(t=0),void 0===w&&(w=0),void 0===h[x]&&(h[x]=0),void 0===u[x]&&(u[x]=0),"function"==typeof get_sitepwlen?get_sitepwlen(sx):1),nx=I&&-1!==Object.values(I).indexOf(a[T].id),tx;if(tx?(console.log("challengecomputescore_async : Found vulnerable site domain2lvl="+M+" sfname="+x),"nonshared"==x&&++w,a[T].challenge_score=0):0<L.length&&L.length<sx?a[T].challenge_score=0:(a[T].challenge_score=challengegetstrength(U,L,G),tx=J&&-1!==Object.values(J).indexOf(a[T].realdomain2lvl),W&&(tx||nx)&&(a[T].is_excluded=!0)),""==O){"nonshared"==x&&t++,h[x]++,void 0!==D&&D.push(T)}else{if("nonshared"==x&&(n+=L.length),void 0===m[x]&&(m[x]=0),m[x]+=L.length,void 0===f[x]&&(f[x]=[]),"nonshared"==x&&!nx){void 0===r[O]&&(r[O]=[]),(void 0===r[O][M]||"function"==typeof r[O][M]&&void 0===r[O][M].push)&&(r[O][M]=[]);try{r[O][M].push(T)}catch(x){return void(O=L=U="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if(void 0===j&&(j=[]),!nx){void 0===j[O]&&(j[O]=[],E[O]=[]),(void 0===j[O][M]||"function"==typeof j[O][M]&&void 0===j[O][M].push)&&(j[O][M]=[],E[O][M]={users:[],hasDifferentUser:!1});try{j[O][M].push(T),E[O][M].hasDifferentUser||E[O][M].users.forEach(function(x){x!==U&&(E[O][M].hasDifferentUser=!0)}),E[O][M].users.push(U)}catch(x){return void(O=L=U="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if("nonshared"!=x){void 0===f[x][O]&&(f[x][O]=[]),(void 0===f[x][O][M]||"function"==typeof f[x][O][M]&&void 0===f[x][O][M].push)&&(f[x][O][M]=[]);try{f[x][O][M].push(T)}catch(x){return void(O=L=U="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}if(++Y>F){var sx=null;try{"function"==typeof setTimeout?sx=setTimeout:"undefined"!=typeof LP&&void 0!==LP.mostRecent&&void 0!==LP.mostRecent().setTimeout&&(sx=LP.mostRecent().setTimeout)}catch(x){}var rx=0;return sx(function(){var x;999<a.length&&(x=Number(((T+1)/a.length*100).toFixed(2)),Math.floor(x)==Math.ceil(x))&&console.log(x+"% score calculation done"),challengecomputescore_async(T+1,e,C,a,s,t,n,r,F,R,V,o,H,i,d,c,X,l,g,v,u,h,p,m,f,_,b,y,S,Z,w,j,z,D,B,E,W,I,J,K,q,G)},0),void(O=L=U="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")}}O=L=U="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}for(P in g_challengeregexcache=[],n=s==t?0:Math.round(10*n/(s-t))/10,r)if(ax=0,r.hasOwnProperty(P)){var N,ox=!1,A;for(A in N=r[P])E[P][A].hasDifferentUser&&(ox=!0),N.hasOwnProperty(A)&&ax++;if(1==ax&&!ox||""==P){if(void 0!==z)for(var ix in r[P])for(var dx in r[P][ix])delete z[r[P][ix][dx]];delete r[P]}else{for(var A in++R,ex=0,N)N.hasOwnProperty(A)&&(ex+=r[P][A].length);for(var A in V+=ex,N)if(N.hasOwnProperty(A))for($ in xx=r[P][A])xx.hasOwnProperty($)&&(T=r[P][A][$],a[T].challenge_numduplicates=ex,a[T].challenge_duplicatescore=a[T].challenge_score/ax)}}P="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",ux();var P="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",cx=0,lx,lx,gx;for(T=0;T<a.length;++T)void 0!==a[T].sfname&&(x=a[T].sfname),void 0===a[T].sfname&&(x="nonshared"),void 0===p[x]&&(p[x]=0),a[T].challenge_scorefinal=a[T].challenge_score,!a[T].usernamedec||-1===a[T].usernamedec.indexOf("@")||a[T].usernamedec in o||(o[a[T].usernamedec]=[],o[a[T].usernamedec].hash=lp_sha2lib.sha256(a[T].usernamedec),o[a[T].usernamedec].link=a[T].link),void 0!==a[T].challenge_dictionary&&void 0!==a[T].challenge_duplicatescore?(a[T].challenge_scorefinal=.5*a[T].challenge_duplicatescore,"nonshared"==x&&++c,"nonshared"!=x&&++p[x]):void 0!==a[T].challenge_dictionary?(a[T].challenge_scorefinal=.5*a[T].challenge_scorefinal,"nonshared"==x&&++c,"nonshared"!=x&&++p[x]):void 0!==a[T].challenge_duplicatescore?(a[T].challenge_scorefinal=a[T].challenge_duplicatescore,void 0===a[T].sfname&&(i+=K&&hx(a[T].id)?0:a[T].challenge_duplicatescore),void 0!==a[T].sfname&&(u[x]+=a[T].challenge_duplicatescore)):(a[T].challenge_score<H&&""!=a[T].passworddecfix&&("nonshared"==x&&++c,"nonshared"!=x)&&++p[x],"nonshared"==x&&(a[T].is_excluded&&!0===a[T].is_excluded&&""!==a[T].passworddec?cx++:i+=K&&hx(a[T].id)?0:a[T].challenge_score,g_avgstrength=s==t?0:Math.round(10*i/(s-t-cx))/10,0!=b.length)&&(g_avgstrength=b.length==t?0:Math.round(10*i/(b.length-t-cx))/10),"nonshared"!=x&&(u[x]+=a[T].challenge_score,X[x]=v[x]==h[x]?0:Math.round(10*u[x]/(l[x].length-h[x]))/10),void 0===_[x]&&(_[x]=0),70<=a[T].challenge_score&&void 0===a[T].sfname&&(d+=2),70<=a[T].challenge_score&&void 0!==a[T].sfname&&(_[x]+=2));100<d&&(d=100),100<_[x]&&(_[x]=100),0<(s=void 0!==b&&0!=b.length?b.length:s)-t&&(K?(gx=7,(lx=70)<(e=Math.round(i/(s-t-cx)*7)/10)&&(console.error("Password part of total score is over 70"),e=lx)):(lx=100)<(e=Math.round(10*(i/(s-t-cx)*.8+d/10))/10)&&(e=lx));for(var T=0;T<S.length;T++)x=S[T],void 0===l[x]&&(l[x]=[]),void 0===h[x]&&(h[x]=0),0<l[x].length-h[x]&&(Z[x]=Math.round(10*(u[x]/(l[x].length-h[x])*.8+_[x]/10))/10);g=(new Date).getTime()-g;var vx=Math.round(g/1e3);Q()}function ux(){var x,e,a,s,s="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";for(s in j=void 0===j?{}:j)if(j.hasOwnProperty(s)){var e,a=0,t=!1,n;for(n in e=j[s])E[s][n].hasDifferentUser&&(t=!0),e.hasOwnProperty(n)&&++a;(1!=a||t)&&""!=s||delete j[s]}}function hx(e){var a=JSON.parse(C),x=a[e]&&"1"===a[e].last_credential_monitoring_state,s=a[e]&&1<Number(a[e].last_credential_monitoring_state),t=q.filter(function(x){return lp_sha2lib.sha256(a[e].unencryptedUsername)===x.usernameHash&&-1<a[e].url.indexOf(x.url)});return x||t.length&&!s}}var baseUrl,startTime,LEVENSHTEIN_DEFAULT,useLevenshteinDistance;"function"==typeof importScripts?("https:"==location.protocol?(importScripts("/js-thirdparty/zxcvbn.js"),importScripts("/js-thirdparty/zxcvbn-ts-core.min.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-common.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-en.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-de.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-es-es.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-fr.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-it.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-nl-be.js"),importScripts("/js-thirdparty/zxcvbn-ts-language-pt-br.js"),importScripts("/js/sjcl/sjcl.js"),importScripts("/js/sha256.js")):(baseUrl=location.pathname.slice(0,-26),importScripts(baseUrl+"/zxcvbn.js"),importScripts(baseUrl+"/zxcvbn-ts.js"),importScripts(baseUrl+"/zxcvbn-ts-language-common.js"),importScripts(baseUrl+"/zxcvbn-ts-language-en.js"),importScripts(baseUrl+"/zxcvbn-ts-language-de.js"),importScripts(baseUrl+"/zxcvbn-ts-language-es-es.js"),importScripts(baseUrl+"/zxcvbn-ts-language-fr.js"),importScripts(baseUrl+"/zxcvbn-ts-language-it.js"),importScripts(baseUrl+"/zxcvbn-ts-language-nl-be.js"),importScripts(baseUrl+"/zxcvbn-ts-language-pt-br.js"),importScripts(baseUrl+"/sjcl.js"),importScripts(baseUrl+"/sha256.js")),onmessage=function(x){var e;"zxcvbn"===x.data.source&&"challengecomputescore_async"===x.data.cmd&&(startTime=(new Date).getTime(),setupZXCVBN(!0),challengecomputescore_async(x.data.curr,x.data.g_totalscore,JSON.parse(x.data.g_sites),x.data.g_aSites&&x.data.g_aSites.length?x.data.g_aSites:[],x.data.g_numsites,x.data.g_numblanksites,x.data.g_avgpasswordlength,x.data.g_aPasswords,x.data.g_MAXNUMCOMPUTESCORE,x.data.g_numduppasswords,x.data.g_numdupsites,x.data.g_usernames,x.data.WEAKPASSWORDSCORE,x.data.g_strengthscore,x.data.g_countscore,x.data.g_numweak,x.data.sharedavgstrength,x.data.SharedAccounts,x.data.g_runtimems,x.data.sfcounts,x.data.sharedstrengthscore,x.data.sharedblanksites,x.data.sharedweak,x.data.sharedavgpasswordlength,x.data.SharedPasswords,x.data.sharedcountscore,x.data.NonSharedAccounts,x.data.g_SFNames,x.data.AllSFNames,x.data.sharedtotalscore,x.data.g_numvulnerablesites,x.data.g_allPasswords,x.data.g_reuse,x.data.g_blanksites,x.data.g_allnumduppasswords,x.data.equivalentDomainCheckList,x.data.isExcludeSwitchedOn,x.data.excludedPasswords,x.data.domainsForAutomaticPasswordExclude,x.data.isFeatureEnabledSecurityDashboard2_0,x.data.dwmAlerts,x.data.isFeatureEnabledPasswordStrengthHardening)),"compute_password_strength"===x.data.cmd&&(void 0===x.data.useLevenshteinDistance&&useLevenshteinDistance!==LEVENSHTEIN_DEFAULT?setupZXCVBN(LEVENSHTEIN_DEFAULT):void 0!==x.data.useLevenshteinDistance&&x.data.useLevenshteinDistance!==useLevenshteinDistance&&setupZXCVBN(x.data.useLevenshteinDistance),e=challengegetstrength(x.data.username,x.data.password,x.data.passwordStrengthHardeningEnabled),postMessage({cmd:"compute_password_strength_result",result:e,password:lp_sha2lib.sha256(x.data.password)}))},setupZXCVBN(useLevenshteinDistance=LEVENSHTEIN_DEFAULT=!1)):console.info("Zxcvbn-Worker initial phase done")}catch(x){console.error("inside-zxcvbn-worker",x)}